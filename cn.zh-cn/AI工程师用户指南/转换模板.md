# 转换模板<a name="modelarts_23_0110"></a>

基于不同的AI框架，ModelArts提供的转换模板如下所示：

-   [Caffe转Ascend](#section540101893016)
-   [Tensorflow frozen\_graph转TFLite](#section152392304460)
-   [Tensorflow saved\_model转TFLite](#section1893164975018)
-   [Tensorflow frozen\_graph转TensorRT](#section11618234125410)
-   [Tensorflow saved\_model转TensorRT](#section57331213565)
-   [Tensorflow frozen graph 转 Ascend](#section73591227115718)
-   [TF-FrozenGraph-To-Ascend](#section146971711107)
-   [TF-SavedModel-To-Ascend](#section14286113714116)
-   [Onnx-To-Ascend-TBE](#section11393428161215)
-   [TF-FrozenGraph-To-Ascend-C32](#section47553019134)
-   [TF-SavedModel-To-Ascend-C32](#section678819203143)
-   [TF-FrozenGraph-To-Ascend-HiLens](#section18183122161514)
-   [TF-SavedModel-To-Ascend-HiLens](#section2098120596165)

## Caffe转Ascend<a name="section540101893016"></a>

转换Caffe框架训练出来的模型， 转换后模型可在Ascend芯片上运行。

此模板无高级选项。

## Tensorflow frozen\_graph转TFLite<a name="section152392304460"></a>

转换Tensorflow框架训练并以“frozen\_graph“格式保存的模型，转换后模型可在ARM上运行。

**表 1**  Tensorflow frozen\_graph转TFLite的高级选项

<a name="table15637194619462"></a>
<table><thead align="left"><tr id="row963714618464"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="p106371846194613"><a name="p106371846194613"></a><a name="p106371846194613"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="p663794664620"><a name="p663794664620"></a><a name="p663794664620"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row1363717463464"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p14637246134617"><a name="p14637246134617"></a><a name="p14637246134617"></a><span class="parmname" id="parmname105957592573"><a name="parmname105957592573"></a><a name="parmname105957592573"></a>“模型输入tensor名称”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p6986926175810"><a name="p6986926175810"></a><a name="p6986926175810"></a>以字符串形式输入模型输入张量名称，以<span class="parmname" id="parmname731733494912"><a name="parmname731733494912"></a><a name="parmname731733494912"></a>“input1:input2”</span>形式表示。</p>
</td>
</tr>
<tr id="row3912195011575"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p189121506575"><a name="p189121506575"></a><a name="p189121506575"></a><span class="parmname" id="parmname20317153417490"><a name="parmname20317153417490"></a><a name="parmname20317153417490"></a>“模型输出tensor名称”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p747749105816"><a name="p747749105816"></a><a name="p747749105816"></a>以字符串形式输入模型输出张量名称，以<span class="parmname" id="parmname15317153419498"><a name="parmname15317153419498"></a><a name="parmname15317153419498"></a>“output1:output2”</span>形式表示。</p>
</td>
</tr>
<tr id="row44101654205718"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p1941025455714"><a name="p1941025455714"></a><a name="p1941025455714"></a><span class="parmname" id="parmname23171334114916"><a name="parmname23171334114916"></a><a name="parmname23171334114916"></a>“量化精度”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p65158153589"><a name="p65158153589"></a><a name="p65158153589"></a>可选择8bit或32bit。32bit表示直接转换模型，8bit表示模型进行量化。</p>
</td>
</tr>
<tr id="row3410155412578"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p154101954165719"><a name="p154101954165719"></a><a name="p154101954165719"></a><span class="parmname" id="parmname4317113444914"><a name="parmname4317113444914"></a><a name="parmname4317113444914"></a>“量化批大小”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p6410185475713"><a name="p6410185475713"></a><a name="p6410185475713"></a>以数值形式输入量化批大小。必须为正整数。</p>
</td>
</tr>
</tbody>
</table>

## Tensorflow saved\_model转TFLite<a name="section1893164975018"></a>

转换Tensorflow框架训练并以“saved\_model“格式保存的模型，转换后模型可在ARM上运行。

**表 2**  Tensorflow saved\_model转TFLite的高级选项

<a name="table1194214581506"></a>
<table><thead align="left"><tr id="row12943195845018"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="p1794385875011"><a name="p1794385875011"></a><a name="p1794385875011"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="p2764135611523"><a name="p2764135611523"></a><a name="p2764135611523"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row1794345818503"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p712142772519"><a name="p712142772519"></a><a name="p712142772519"></a><span class="parmname" id="parmname131262762519"><a name="parmname131262762519"></a><a name="parmname131262762519"></a>“模型签名”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p794310585504"><a name="p794310585504"></a><a name="p794310585504"></a>以字符串形式输入模型输入tensor签名，默认会选择第一个签名。</p>
</td>
</tr>
<tr id="row49431058125016"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p3943155865015"><a name="p3943155865015"></a><a name="p3943155865015"></a><span class="parmname" id="parmname1024713432518"><a name="parmname1024713432518"></a><a name="parmname1024713432518"></a>“传入模型标签”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p955714782617"><a name="p955714782617"></a><a name="p955714782617"></a>以字符串形式输入模型输出标签，默认会选择第一个标签。</p>
</td>
</tr>
<tr id="row857618500254"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p15576135032516"><a name="p15576135032516"></a><a name="p15576135032516"></a><span class="parmname" id="parmname1321217591257"><a name="parmname1321217591257"></a><a name="parmname1321217591257"></a>“量化精度”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p1720152422616"><a name="p1720152422616"></a><a name="p1720152422616"></a>可选择8bit或32bit。32bit表示直接转换模型，8bit表示模型进行量化。</p>
</td>
</tr>
<tr id="row201646413257"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p1316564110259"><a name="p1316564110259"></a><a name="p1316564110259"></a><span class="parmname" id="parmname1892155192613"><a name="parmname1892155192613"></a><a name="parmname1892155192613"></a>“量化批大小”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p12165204132513"><a name="p12165204132513"></a><a name="p12165204132513"></a>以数值形式输入量化批大小。必须为正整数。</p>
</td>
</tr>
</tbody>
</table>

## Tensorflow frozen\_graph转TensorRT<a name="section11618234125410"></a>

转换Tensorflow框架训练并以“frozen\_graph“格式保存的模型，转换后模型可在GPU上运行。

**表 3**  Tensorflow frozen\_graph转TensorRT的高级选项

<a name="table1358011474547"></a>
<table><thead align="left"><tr id="row558011476545"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="p266411114286"><a name="p266411114286"></a><a name="p266411114286"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="p1458014711548"><a name="p1458014711548"></a><a name="p1458014711548"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row14580204785410"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p17707229172815"><a name="p17707229172815"></a><a name="p17707229172815"></a><span class="parmname" id="parmname670720298287"><a name="parmname670720298287"></a><a name="parmname670720298287"></a>“模型输入tensor名称”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p19145164114298"><a name="p19145164114298"></a><a name="p19145164114298"></a>以字符串形式输入模型输入张量名称，以<span class="parmname" id="parmname20854134015554"><a name="parmname20854134015554"></a><a name="parmname20854134015554"></a>“input1:input2”</span>形式表示。</p>
</td>
</tr>
<tr id="row7674164719286"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p067424792817"><a name="p067424792817"></a><a name="p067424792817"></a><span class="parmname" id="parmname11268158172812"><a name="parmname11268158172812"></a><a name="parmname11268158172812"></a>“模型输出tensor名称”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p1787973132913"><a name="p1787973132913"></a><a name="p1787973132913"></a>以字符串形式输入模型输出张量名称，以<span class="parmname" id="parmname7879431162914"><a name="parmname7879431162914"></a><a name="parmname7879431162914"></a>“output1:output2”</span>形式表示。</p>
</td>
</tr>
<tr id="row7382124232811"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p14382124212280"><a name="p14382124212280"></a><a name="p14382124212280"></a><span class="parmname" id="parmname887711314295"><a name="parmname887711314295"></a><a name="parmname887711314295"></a>“量化精度”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p193821242162818"><a name="p193821242162818"></a><a name="p193821242162818"></a>可选择8bit或32bit。32bit表示直接转换模型，8bit表示模型进行量化。</p>
</td>
</tr>
<tr id="row67737152814"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p12710377280"><a name="p12710377280"></a><a name="p12710377280"></a><span class="parmname" id="parmname1844914882917"><a name="parmname1844914882917"></a><a name="parmname1844914882917"></a>“量化批大小”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p5783717289"><a name="p5783717289"></a><a name="p5783717289"></a>以数值形式输入量化批大小。必须为正整数。</p>
</td>
</tr>
</tbody>
</table>

## Tensorflow saved\_model转TensorRT<a name="section57331213565"></a>

转换Tensorflow框架训练并以“saved\_model“格式保存的模型，转换后模型可在GPU上运行。

**表 4**  Tensorflow saved\_model转TensorRT的高级选项

<a name="table136211191565"></a>
<table><thead align="left"><tr id="row56241955615"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="p662121914562"><a name="p662121914562"></a><a name="p662121914562"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="p162219155614"><a name="p162219155614"></a><a name="p162219155614"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row162119145615"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p12228104313716"><a name="p12228104313716"></a><a name="p12228104313716"></a><span class="parmname" id="parmname6228114363720"><a name="parmname6228114363720"></a><a name="parmname6228114363720"></a>“模型签名”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p3621719115610"><a name="p3621719115610"></a><a name="p3621719115610"></a>以字符串形式输入模型输入tensor签名，默认会选择第一个签名。</p>
</td>
</tr>
<tr id="row26281915561"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p17476651153720"><a name="p17476651153720"></a><a name="p17476651153720"></a><span class="parmname" id="parmname12476155110372"><a name="parmname12476155110372"></a><a name="parmname12476155110372"></a>“传入模型标签”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p51832050113818"><a name="p51832050113818"></a><a name="p51832050113818"></a>以字符串形式输入模型输出标签，默认会选择第一个标签。</p>
</td>
</tr>
<tr id="row257081153811"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p55708115384"><a name="p55708115384"></a><a name="p55708115384"></a><span class="parmname" id="parmname17248198193818"><a name="parmname17248198193818"></a><a name="parmname17248198193818"></a>“量化精度”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p75701718386"><a name="p75701718386"></a><a name="p75701718386"></a>可选择8bit或32bit。32bit表示直接转换模型，8bit表示模型进行量化。</p>
</td>
</tr>
<tr id="row83941457103711"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p53941257113710"><a name="p53941257113710"></a><a name="p53941257113710"></a><span class="parmname" id="parmname15628121518384"><a name="parmname15628121518384"></a><a name="parmname15628121518384"></a>“量化批大小”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p1639455714376"><a name="p1639455714376"></a><a name="p1639455714376"></a>以数值形式输入量化批大小。必须为正整数。</p>
</td>
</tr>
</tbody>
</table>

## Tensorflow frozen graph 转 Ascend<a name="section73591227115718"></a>

转换Tensorflow框架训练并以“frozen\_graph“格式保存的模型，转换后模型可在Ascend上运行。

**表 5**  Tensorflow frozen graph 转 Ascend的高级选项

<a name="table10221532155720"></a>
<table><thead align="left"><tr id="row172333211579"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="p20231432155715"><a name="p20231432155715"></a><a name="p20231432155715"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="p2864184413917"><a name="p2864184413917"></a><a name="p2864184413917"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row923332195710"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p132312328577"><a name="p132312328577"></a><a name="p132312328577"></a><span class="parmname" id="parmname1756174314217"><a name="parmname1756174314217"></a><a name="parmname1756174314217"></a>“输入张量形状”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p2231832105710"><a name="p2231832105710"></a><a name="p2231832105710"></a>模型输入数据的shape，输入数据格式为NHWC，如<span class="parmvalue" id="parmvalue1929619814577"><a name="parmvalue1929619814577"></a><a name="parmvalue1929619814577"></a>“input_name:1,224,224,3”</span>，必填项。<span class="parmname" id="parmname7296188105716"><a name="parmname7296188105716"></a><a name="parmname7296188105716"></a>“input_name”</span>必须是转换前的网络模型中的节点名称。当模型存在动态shape输入时必须提供。例如<span class="parmname" id="parmname15296148175713"><a name="parmname15296148175713"></a><a name="parmname15296148175713"></a>“input_name1:?,h,w,c”</span>，该参数必填，其中“?”为batch数，表示1次处理的图片数量，需要根据实际情况填写，用于将动态shape的原始模型转换为固定shape的离线模型。目前不支持批量特性，转换输入张量形状batch只能为1。</p>
</td>
</tr>
</tbody>
</table>

## TF-FrozenGraph-To-Ascend<a name="section146971711107"></a>

转换Tensorflow框架训练并以“frozen\_graph“格式保存的模型，转换后模型可在Ascend上运行。转换时支持使用基于TE（Tensor Engine）开发的自定义算子\(TE算子\)。

**表 6**  支持自定义算子转换模板的高级选项

<a name="table0511832181018"></a>
<table><thead align="left"><tr id="row1951193231017"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="p851103271017"><a name="p851103271017"></a><a name="p851103271017"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="p1351114322109"><a name="p1351114322109"></a><a name="p1351114322109"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row18511143212101"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p074565765813"><a name="p074565765813"></a><a name="p074565765813"></a><span class="parmname" id="parmname17451757195819"><a name="parmname17451757195819"></a><a name="parmname17451757195819"></a>“输入张量形状”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p01741335619"><a name="p01741335619"></a><a name="p01741335619"></a>模型输入数据的shape，如<span class="parmvalue" id="parmvalue16741229121118"><a name="parmvalue16741229121118"></a><a name="parmvalue16741229121118"></a>“input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2”</span>。<span class="parmname" id="parmname1967416299115"><a name="parmname1967416299115"></a><a name="parmname1967416299115"></a>“input_name”</span>必须是转换前的网络模型中的节点名称。当模型存在动态shape输入时必须提供。例如<span class="parmname" id="parmname467462912114"><a name="parmname467462912114"></a><a name="parmname467462912114"></a>“input_name1:?,h,w,c”</span>，该参数必填，其中“?”为batch数，表示1次处理的图片数量，需要根据实际情况填写，用于将动态shape的原始模型转换为固定shape的离线模型。目前不支持批量特性，转换输入张量形状batch只能为1。转换时系统会解析输入模型获取输入张量并打印在日志中，如果不了解所使用模型的输入张量，可参考日志中的解析结果。</p>
</td>
</tr>
<tr id="row2070976135919"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p270976195913"><a name="p270976195913"></a><a name="p270976195913"></a><span class="parmname" id="parmname11107121995920"><a name="parmname11107121995920"></a><a name="parmname11107121995920"></a>“输入数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p1770920611599"><a name="p1770920611599"></a><a name="p1770920611599"></a>支持NCHW和NHWC，默认是NHWC。当原始框架是TensorFlow时，默认是NHWC。如果实际是NCHW的话，需要通过此参数指定NCHW。原始框架为Caffe时，只支持NCHW格式。</p>
</td>
</tr>
<tr id="row457718218590"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p357792115918"><a name="p357792115918"></a><a name="p357792115918"></a><span class="parmname" id="parmname7342113205910"><a name="parmname7342113205910"></a><a name="parmname7342113205910"></a>“转换输出节点”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p145771224593"><a name="p145771224593"></a><a name="p145771224593"></a>指定输出节点，例如<span class="parmvalue" id="parmvalue187591741716"><a name="parmvalue187591741716"></a><a name="parmvalue187591741716"></a>“node_name1:0;node_name1:1;node_name2:0”</span>，其中<span class="parmname" id="parmname1975964417"><a name="parmname1975964417"></a><a name="parmname1975964417"></a>“node_name”</span>必须是模型转换前的网络模型中的节点名称，冒号后的数字表示第几个输出，例如<span class="parmvalue" id="parmvalue576020415112"><a name="parmvalue576020415112"></a><a name="parmvalue576020415112"></a>“node_name1:0”</span>，表示节点名称为<span class="parmname" id="parmname18760341517"><a name="parmname18760341517"></a><a name="parmname18760341517"></a>“node_name1”</span>的第0个输出。如果不指定输出节点，则模型的输出默认为最后一层的算子信息，某些情况下，用户想要查看某层算子参数是否合适，则需要将该层算子的参数输出，即可以在模型转换时通过该参数指定输出某层算子。转换时系统会解析输入模型获取输出节点并打印在日志中，如果不了解所使用模型的输入张量，可以参考日志中的解析结果。</p>
</td>
</tr>
<tr id="row239453865914"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p739413812590"><a name="p739413812590"></a><a name="p739413812590"></a><span class="parmname" id="parmname37739541591"><a name="parmname37739541591"></a><a name="parmname37739541591"></a>“优选数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p123949383592"><a name="p123949383592"></a><a name="p123949383592"></a>指定网络算子优先选用的数据格式，<span class="parmvalue" id="parmvalue31736351003"><a name="parmvalue31736351003"></a><a name="parmvalue31736351003"></a>“ND（N&lt;=4）”</span>和<span class="parmvalue" id="parmvalue617363512017"><a name="parmvalue617363512017"></a><a name="parmvalue617363512017"></a>“5D”</span>。仅在网络中算子的输入数据同时支持<span class="parmvalue" id="parmvalue1617393519018"><a name="parmvalue1617393519018"></a><a name="parmvalue1617393519018"></a>“ND”</span>和<span class="parmvalue" id="parmvalue817310357018"><a name="parmvalue817310357018"></a><a name="parmvalue817310357018"></a>“5D”</span>两种格式时，指定该参数才会生效。<span class="parmvalue" id="parmvalue417310356011"><a name="parmvalue417310356011"></a><a name="parmvalue417310356011"></a>“ND”</span>表示模型中算子按NCHW转换成通用格式，<span class="parmvalue" id="parmvalue9173113519013"><a name="parmvalue9173113519013"></a><a name="parmvalue9173113519013"></a>“5D”</span>表示模型中算子按华为自研的5维转换成华为格式。<span class="parmvalue" id="parmvalue01733354016"><a name="parmvalue01733354016"></a><a name="parmvalue01733354016"></a>“5D”</span>为默认值。</p>
</td>
</tr>
<tr id="row18385134265914"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p138554255911"><a name="p138554255911"></a><a name="p138554255911"></a><span class="parmname" id="parmname41921813011"><a name="parmname41921813011"></a><a name="parmname41921813011"></a>“生成高精度模型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p5385124220595"><a name="p5385124220595"></a><a name="p5385124220595"></a>指定是否生成高精度FP16 Davinci模型。<span class="parmvalue" id="parmvalue398914277020"><a name="parmvalue398914277020"></a><a name="parmvalue398914277020"></a>“0”</span>为默认值，表示生成普通FP16 Davinci模型，推理性能更好。<span class="parmvalue" id="parmvalue189899273018"><a name="parmvalue189899273018"></a><a name="parmvalue189899273018"></a>“1”</span>表示生成高精度FP16 Davinci模型，推理精度更好。高精度当前仅支持Caffe算子（Convolution、Pooling、FullConnection）和TensorFlow算子（tf.nn.conv2d、tf.nn.max_poo）。</p>
</td>
</tr>
<tr id="row8560962014"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p2561261001"><a name="p2561261001"></a><a name="p2561261001"></a><span class="parmname" id="parmname115211915807"><a name="parmname115211915807"></a><a name="parmname115211915807"></a>“网络输出数据类型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p226414215013"><a name="p226414215013"></a><a name="p226414215013"></a>FP32为默认值，推荐分类网络、检测网络使用。图像超分辨率网络，推荐使用UINT8，推理性能更好。</p>
</td>
</tr>
</tbody>
</table>

## TF-SavedModel-To-Ascend<a name="section14286113714116"></a>

转换Tensorflow框架训练并以“saved\_model“格式保存的模型，转换后模型可在Ascend上运行。转换时支持使用基于TE（Tensor Engine）开发的自定义算子\(TE算子\)。

**表 7**  支持自定义算子转换模板的高级选项

<a name="table10295115251114"></a>
<table><thead align="left"><tr id="modelarts_23_0110_row1951193231017"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="modelarts_23_0110_p851103271017"><a name="modelarts_23_0110_p851103271017"></a><a name="modelarts_23_0110_p851103271017"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="modelarts_23_0110_p1351114322109"><a name="modelarts_23_0110_p1351114322109"></a><a name="modelarts_23_0110_p1351114322109"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="modelarts_23_0110_row18511143212101"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p074565765813"><a name="modelarts_23_0110_p074565765813"></a><a name="modelarts_23_0110_p074565765813"></a><span class="parmname" id="modelarts_23_0110_parmname17451757195819"><a name="modelarts_23_0110_parmname17451757195819"></a><a name="modelarts_23_0110_parmname17451757195819"></a>“输入张量形状”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p01741335619"><a name="modelarts_23_0110_p01741335619"></a><a name="modelarts_23_0110_p01741335619"></a>模型输入数据的shape，如<span class="parmvalue" id="modelarts_23_0110_parmvalue16741229121118"><a name="modelarts_23_0110_parmvalue16741229121118"></a><a name="modelarts_23_0110_parmvalue16741229121118"></a>“input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2”</span>。<span class="parmname" id="modelarts_23_0110_parmname1967416299115"><a name="modelarts_23_0110_parmname1967416299115"></a><a name="modelarts_23_0110_parmname1967416299115"></a>“input_name”</span>必须是转换前的网络模型中的节点名称。当模型存在动态shape输入时必须提供。例如<span class="parmname" id="modelarts_23_0110_parmname467462912114"><a name="modelarts_23_0110_parmname467462912114"></a><a name="modelarts_23_0110_parmname467462912114"></a>“input_name1:?,h,w,c”</span>，该参数必填，其中“?”为batch数，表示1次处理的图片数量，需要根据实际情况填写，用于将动态shape的原始模型转换为固定shape的离线模型。目前不支持批量特性，转换输入张量形状batch只能为1。转换时系统会解析输入模型获取输入张量并打印在日志中，如果不了解所使用模型的输入张量，可参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row2070976135919"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p270976195913"><a name="modelarts_23_0110_p270976195913"></a><a name="modelarts_23_0110_p270976195913"></a><span class="parmname" id="modelarts_23_0110_parmname11107121995920"><a name="modelarts_23_0110_parmname11107121995920"></a><a name="modelarts_23_0110_parmname11107121995920"></a>“输入数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p1770920611599"><a name="modelarts_23_0110_p1770920611599"></a><a name="modelarts_23_0110_p1770920611599"></a>支持NCHW和NHWC，默认是NHWC。当原始框架是TensorFlow时，默认是NHWC。如果实际是NCHW的话，需要通过此参数指定NCHW。原始框架为Caffe时，只支持NCHW格式。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row457718218590"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p357792115918"><a name="modelarts_23_0110_p357792115918"></a><a name="modelarts_23_0110_p357792115918"></a><span class="parmname" id="modelarts_23_0110_parmname7342113205910"><a name="modelarts_23_0110_parmname7342113205910"></a><a name="modelarts_23_0110_parmname7342113205910"></a>“转换输出节点”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p145771224593"><a name="modelarts_23_0110_p145771224593"></a><a name="modelarts_23_0110_p145771224593"></a>指定输出节点，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue187591741716"><a name="modelarts_23_0110_parmvalue187591741716"></a><a name="modelarts_23_0110_parmvalue187591741716"></a>“node_name1:0;node_name1:1;node_name2:0”</span>，其中<span class="parmname" id="modelarts_23_0110_parmname1975964417"><a name="modelarts_23_0110_parmname1975964417"></a><a name="modelarts_23_0110_parmname1975964417"></a>“node_name”</span>必须是模型转换前的网络模型中的节点名称，冒号后的数字表示第几个输出，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue576020415112"><a name="modelarts_23_0110_parmvalue576020415112"></a><a name="modelarts_23_0110_parmvalue576020415112"></a>“node_name1:0”</span>，表示节点名称为<span class="parmname" id="modelarts_23_0110_parmname18760341517"><a name="modelarts_23_0110_parmname18760341517"></a><a name="modelarts_23_0110_parmname18760341517"></a>“node_name1”</span>的第0个输出。如果不指定输出节点，则模型的输出默认为最后一层的算子信息，某些情况下，用户想要查看某层算子参数是否合适，则需要将该层算子的参数输出，即可以在模型转换时通过该参数指定输出某层算子。转换时系统会解析输入模型获取输出节点并打印在日志中，如果不了解所使用模型的输入张量，可以参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row239453865914"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p739413812590"><a name="modelarts_23_0110_p739413812590"></a><a name="modelarts_23_0110_p739413812590"></a><span class="parmname" id="modelarts_23_0110_parmname37739541591"><a name="modelarts_23_0110_parmname37739541591"></a><a name="modelarts_23_0110_parmname37739541591"></a>“优选数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p123949383592"><a name="modelarts_23_0110_p123949383592"></a><a name="modelarts_23_0110_p123949383592"></a>指定网络算子优先选用的数据格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue31736351003"><a name="modelarts_23_0110_parmvalue31736351003"></a><a name="modelarts_23_0110_parmvalue31736351003"></a>“ND（N&lt;=4）”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue617363512017"><a name="modelarts_23_0110_parmvalue617363512017"></a><a name="modelarts_23_0110_parmvalue617363512017"></a>“5D”</span>。仅在网络中算子的输入数据同时支持<span class="parmvalue" id="modelarts_23_0110_parmvalue1617393519018"><a name="modelarts_23_0110_parmvalue1617393519018"></a><a name="modelarts_23_0110_parmvalue1617393519018"></a>“ND”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue817310357018"><a name="modelarts_23_0110_parmvalue817310357018"></a><a name="modelarts_23_0110_parmvalue817310357018"></a>“5D”</span>两种格式时，指定该参数才会生效。<span class="parmvalue" id="modelarts_23_0110_parmvalue417310356011"><a name="modelarts_23_0110_parmvalue417310356011"></a><a name="modelarts_23_0110_parmvalue417310356011"></a>“ND”</span>表示模型中算子按NCHW转换成通用格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue9173113519013"><a name="modelarts_23_0110_parmvalue9173113519013"></a><a name="modelarts_23_0110_parmvalue9173113519013"></a>“5D”</span>表示模型中算子按华为自研的5维转换成华为格式。<span class="parmvalue" id="modelarts_23_0110_parmvalue01733354016"><a name="modelarts_23_0110_parmvalue01733354016"></a><a name="modelarts_23_0110_parmvalue01733354016"></a>“5D”</span>为默认值。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row18385134265914"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p138554255911"><a name="modelarts_23_0110_p138554255911"></a><a name="modelarts_23_0110_p138554255911"></a><span class="parmname" id="modelarts_23_0110_parmname41921813011"><a name="modelarts_23_0110_parmname41921813011"></a><a name="modelarts_23_0110_parmname41921813011"></a>“生成高精度模型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p5385124220595"><a name="modelarts_23_0110_p5385124220595"></a><a name="modelarts_23_0110_p5385124220595"></a>指定是否生成高精度FP16 Davinci模型。<span class="parmvalue" id="modelarts_23_0110_parmvalue398914277020"><a name="modelarts_23_0110_parmvalue398914277020"></a><a name="modelarts_23_0110_parmvalue398914277020"></a>“0”</span>为默认值，表示生成普通FP16 Davinci模型，推理性能更好。<span class="parmvalue" id="modelarts_23_0110_parmvalue189899273018"><a name="modelarts_23_0110_parmvalue189899273018"></a><a name="modelarts_23_0110_parmvalue189899273018"></a>“1”</span>表示生成高精度FP16 Davinci模型，推理精度更好。高精度当前仅支持Caffe算子（Convolution、Pooling、FullConnection）和TensorFlow算子（tf.nn.conv2d、tf.nn.max_poo）。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row8560962014"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p2561261001"><a name="modelarts_23_0110_p2561261001"></a><a name="modelarts_23_0110_p2561261001"></a><span class="parmname" id="modelarts_23_0110_parmname115211915807"><a name="modelarts_23_0110_parmname115211915807"></a><a name="modelarts_23_0110_parmname115211915807"></a>“网络输出数据类型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p226414215013"><a name="modelarts_23_0110_p226414215013"></a><a name="modelarts_23_0110_p226414215013"></a>FP32为默认值，推荐分类网络、检测网络使用。图像超分辨率网络，推荐使用UINT8，推理性能更好。</p>
</td>
</tr>
</tbody>
</table>

## Onnx-To-Ascend-TBE<a name="section11393428161215"></a>

转换onnx格式保存的模型，模型首先被转换为frozen\_graph格式，然后再转换为可在Ascend上运行的模型。转换时支持使用基于TBE（Tensor Based Engine）开发的自定义算子\(TBE算子\)。

**表 8**  支持自定义算子转换模板的高级选项

<a name="table199091646171213"></a>
<table><thead align="left"><tr id="modelarts_23_0110_row1951193231017_1"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="modelarts_23_0110_p851103271017_1"><a name="modelarts_23_0110_p851103271017_1"></a><a name="modelarts_23_0110_p851103271017_1"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="modelarts_23_0110_p1351114322109_1"><a name="modelarts_23_0110_p1351114322109_1"></a><a name="modelarts_23_0110_p1351114322109_1"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="modelarts_23_0110_row18511143212101_1"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p074565765813_1"><a name="modelarts_23_0110_p074565765813_1"></a><a name="modelarts_23_0110_p074565765813_1"></a><span class="parmname" id="modelarts_23_0110_parmname17451757195819_1"><a name="modelarts_23_0110_parmname17451757195819_1"></a><a name="modelarts_23_0110_parmname17451757195819_1"></a>“输入张量形状”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p01741335619_1"><a name="modelarts_23_0110_p01741335619_1"></a><a name="modelarts_23_0110_p01741335619_1"></a>模型输入数据的shape，如<span class="parmvalue" id="modelarts_23_0110_parmvalue16741229121118_1"><a name="modelarts_23_0110_parmvalue16741229121118_1"></a><a name="modelarts_23_0110_parmvalue16741229121118_1"></a>“input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2”</span>。<span class="parmname" id="modelarts_23_0110_parmname1967416299115_1"><a name="modelarts_23_0110_parmname1967416299115_1"></a><a name="modelarts_23_0110_parmname1967416299115_1"></a>“input_name”</span>必须是转换前的网络模型中的节点名称。当模型存在动态shape输入时必须提供。例如<span class="parmname" id="modelarts_23_0110_parmname467462912114_1"><a name="modelarts_23_0110_parmname467462912114_1"></a><a name="modelarts_23_0110_parmname467462912114_1"></a>“input_name1:?,h,w,c”</span>，该参数必填，其中“?”为batch数，表示1次处理的图片数量，需要根据实际情况填写，用于将动态shape的原始模型转换为固定shape的离线模型。目前不支持批量特性，转换输入张量形状batch只能为1。转换时系统会解析输入模型获取输入张量并打印在日志中，如果不了解所使用模型的输入张量，可参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row2070976135919_1"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p270976195913_1"><a name="modelarts_23_0110_p270976195913_1"></a><a name="modelarts_23_0110_p270976195913_1"></a><span class="parmname" id="modelarts_23_0110_parmname11107121995920_1"><a name="modelarts_23_0110_parmname11107121995920_1"></a><a name="modelarts_23_0110_parmname11107121995920_1"></a>“输入数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p1770920611599_1"><a name="modelarts_23_0110_p1770920611599_1"></a><a name="modelarts_23_0110_p1770920611599_1"></a>支持NCHW和NHWC，默认是NHWC。当原始框架是TensorFlow时，默认是NHWC。如果实际是NCHW的话，需要通过此参数指定NCHW。原始框架为Caffe时，只支持NCHW格式。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row457718218590_1"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p357792115918_1"><a name="modelarts_23_0110_p357792115918_1"></a><a name="modelarts_23_0110_p357792115918_1"></a><span class="parmname" id="modelarts_23_0110_parmname7342113205910_1"><a name="modelarts_23_0110_parmname7342113205910_1"></a><a name="modelarts_23_0110_parmname7342113205910_1"></a>“转换输出节点”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p145771224593_1"><a name="modelarts_23_0110_p145771224593_1"></a><a name="modelarts_23_0110_p145771224593_1"></a>指定输出节点，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue187591741716_1"><a name="modelarts_23_0110_parmvalue187591741716_1"></a><a name="modelarts_23_0110_parmvalue187591741716_1"></a>“node_name1:0;node_name1:1;node_name2:0”</span>，其中<span class="parmname" id="modelarts_23_0110_parmname1975964417_1"><a name="modelarts_23_0110_parmname1975964417_1"></a><a name="modelarts_23_0110_parmname1975964417_1"></a>“node_name”</span>必须是模型转换前的网络模型中的节点名称，冒号后的数字表示第几个输出，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue576020415112_1"><a name="modelarts_23_0110_parmvalue576020415112_1"></a><a name="modelarts_23_0110_parmvalue576020415112_1"></a>“node_name1:0”</span>，表示节点名称为<span class="parmname" id="modelarts_23_0110_parmname18760341517_1"><a name="modelarts_23_0110_parmname18760341517_1"></a><a name="modelarts_23_0110_parmname18760341517_1"></a>“node_name1”</span>的第0个输出。如果不指定输出节点，则模型的输出默认为最后一层的算子信息，某些情况下，用户想要查看某层算子参数是否合适，则需要将该层算子的参数输出，即可以在模型转换时通过该参数指定输出某层算子。转换时系统会解析输入模型获取输出节点并打印在日志中，如果不了解所使用模型的输入张量，可以参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row239453865914_1"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p739413812590_1"><a name="modelarts_23_0110_p739413812590_1"></a><a name="modelarts_23_0110_p739413812590_1"></a><span class="parmname" id="modelarts_23_0110_parmname37739541591_1"><a name="modelarts_23_0110_parmname37739541591_1"></a><a name="modelarts_23_0110_parmname37739541591_1"></a>“优选数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p123949383592_1"><a name="modelarts_23_0110_p123949383592_1"></a><a name="modelarts_23_0110_p123949383592_1"></a>指定网络算子优先选用的数据格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue31736351003_1"><a name="modelarts_23_0110_parmvalue31736351003_1"></a><a name="modelarts_23_0110_parmvalue31736351003_1"></a>“ND（N&lt;=4）”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue617363512017_1"><a name="modelarts_23_0110_parmvalue617363512017_1"></a><a name="modelarts_23_0110_parmvalue617363512017_1"></a>“5D”</span>。仅在网络中算子的输入数据同时支持<span class="parmvalue" id="modelarts_23_0110_parmvalue1617393519018_1"><a name="modelarts_23_0110_parmvalue1617393519018_1"></a><a name="modelarts_23_0110_parmvalue1617393519018_1"></a>“ND”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue817310357018_1"><a name="modelarts_23_0110_parmvalue817310357018_1"></a><a name="modelarts_23_0110_parmvalue817310357018_1"></a>“5D”</span>两种格式时，指定该参数才会生效。<span class="parmvalue" id="modelarts_23_0110_parmvalue417310356011_1"><a name="modelarts_23_0110_parmvalue417310356011_1"></a><a name="modelarts_23_0110_parmvalue417310356011_1"></a>“ND”</span>表示模型中算子按NCHW转换成通用格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue9173113519013_1"><a name="modelarts_23_0110_parmvalue9173113519013_1"></a><a name="modelarts_23_0110_parmvalue9173113519013_1"></a>“5D”</span>表示模型中算子按华为自研的5维转换成华为格式。<span class="parmvalue" id="modelarts_23_0110_parmvalue01733354016_1"><a name="modelarts_23_0110_parmvalue01733354016_1"></a><a name="modelarts_23_0110_parmvalue01733354016_1"></a>“5D”</span>为默认值。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row18385134265914_1"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p138554255911_1"><a name="modelarts_23_0110_p138554255911_1"></a><a name="modelarts_23_0110_p138554255911_1"></a><span class="parmname" id="modelarts_23_0110_parmname41921813011_1"><a name="modelarts_23_0110_parmname41921813011_1"></a><a name="modelarts_23_0110_parmname41921813011_1"></a>“生成高精度模型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p5385124220595_1"><a name="modelarts_23_0110_p5385124220595_1"></a><a name="modelarts_23_0110_p5385124220595_1"></a>指定是否生成高精度FP16 Davinci模型。<span class="parmvalue" id="modelarts_23_0110_parmvalue398914277020_1"><a name="modelarts_23_0110_parmvalue398914277020_1"></a><a name="modelarts_23_0110_parmvalue398914277020_1"></a>“0”</span>为默认值，表示生成普通FP16 Davinci模型，推理性能更好。<span class="parmvalue" id="modelarts_23_0110_parmvalue189899273018_1"><a name="modelarts_23_0110_parmvalue189899273018_1"></a><a name="modelarts_23_0110_parmvalue189899273018_1"></a>“1”</span>表示生成高精度FP16 Davinci模型，推理精度更好。高精度当前仅支持Caffe算子（Convolution、Pooling、FullConnection）和TensorFlow算子（tf.nn.conv2d、tf.nn.max_poo）。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row8560962014_1"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p2561261001_1"><a name="modelarts_23_0110_p2561261001_1"></a><a name="modelarts_23_0110_p2561261001_1"></a><span class="parmname" id="modelarts_23_0110_parmname115211915807_1"><a name="modelarts_23_0110_parmname115211915807_1"></a><a name="modelarts_23_0110_parmname115211915807_1"></a>“网络输出数据类型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p226414215013_1"><a name="modelarts_23_0110_p226414215013_1"></a><a name="modelarts_23_0110_p226414215013_1"></a>FP32为默认值，推荐分类网络、检测网络使用。图像超分辨率网络，推荐使用UINT8，推理性能更好。</p>
</td>
</tr>
</tbody>
</table>

## TF-FrozenGraph-To-Ascend-C32<a name="section47553019134"></a>

转换Tensorflow框架训练并以“frozen\_graph“格式保存的模型，转换后模型可在Ascend上运行。转换时支持使用基于TBE（Tensor Based Engine）开发的自定义算子\(TBE算子\)。

**表 9**  支持自定义算子转换模板的高级选项

<a name="table397415449135"></a>
<table><thead align="left"><tr id="row194110845913"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="p15413812592"><a name="p15413812592"></a><a name="p15413812592"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="p54117885910"><a name="p54117885910"></a><a name="p54117885910"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="row106358145915"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p46215818597"><a name="p46215818597"></a><a name="p46215818597"></a><span class="parmname" id="parmname56213815914"><a name="parmname56213815914"></a><a name="parmname56213815914"></a>“输入张量形状”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p1563482590"><a name="p1563482590"></a><a name="p1563482590"></a>模型输入数据的shape，如<span class="parmvalue" id="parmvalue56219845917"><a name="parmvalue56219845917"></a><a name="parmvalue56219845917"></a>“input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2”</span>。<span class="parmname" id="parmname13621683594"><a name="parmname13621683594"></a><a name="parmname13621683594"></a>“input_name”</span>必须是转换前的网络模型中的节点名称。当模型存在动态shape输入时必须提供。例如<span class="parmname" id="parmname116212845920"><a name="parmname116212845920"></a><a name="parmname116212845920"></a>“input_name1:?,h,w,c”</span>，该参数必填，其中“?”为batch数，表示1次处理的图片数量，需要根据实际情况填写，用于将动态shape的原始模型转换为固定shape的离线模型。目前不支持批量特性，转换输入张量形状batch只能为1。转换时系统会解析输入模型获取输入张量并打印在日志中，如果不了解所使用模型的输入张量，可参考日志中的解析结果。</p>
</td>
</tr>
<tr id="row19631781592"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p56328165914"><a name="p56328165914"></a><a name="p56328165914"></a><span class="parmname" id="parmname563884596"><a name="parmname563884596"></a><a name="parmname563884596"></a>“输入数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p17636817599"><a name="p17636817599"></a><a name="p17636817599"></a>支持NCHW和NHWC，默认是NHWC。当原始框架是TensorFlow时，默认是NHWC。如果实际是NCHW的话，需要通过此参数指定NCHW。原始框架为Caffe时，只支持NCHW格式。</p>
</td>
</tr>
<tr id="row16643835910"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p763118105920"><a name="p763118105920"></a><a name="p763118105920"></a><span class="parmname" id="parmname1263168135915"><a name="parmname1263168135915"></a><a name="parmname1263168135915"></a>“转换输出节点”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p1664148105913"><a name="p1664148105913"></a><a name="p1664148105913"></a>指定输出节点，例如<span class="parmvalue" id="parmvalue863128125920"><a name="parmvalue863128125920"></a><a name="parmvalue863128125920"></a>“node_name1:0;node_name1:1;node_name2:0”</span>，其中<span class="parmname" id="parmname126318885910"><a name="parmname126318885910"></a><a name="parmname126318885910"></a>“node_name”</span>必须是模型转换前的网络模型中的节点名称，冒号后的数字表示第几个输出，例如<span class="parmvalue" id="parmvalue96438195916"><a name="parmvalue96438195916"></a><a name="parmvalue96438195916"></a>“node_name1:0”</span>，表示节点名称为<span class="parmname" id="parmname364986593"><a name="parmname364986593"></a><a name="parmname364986593"></a>“node_name1”</span>的第0个输出。如果不指定输出节点，则模型的输出默认为最后一层的算子信息，某些情况下，用户想要查看某层算子参数是否合适，则需要将该层算子的参数输出，即可以在模型转换时通过该参数指定输出某层算子。转换时系统会解析输入模型获取输出节点并打印在日志中，如果不了解所使用模型的输入张量，可以参考日志中的解析结果。</p>
</td>
</tr>
<tr id="row1565586592"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p56417825913"><a name="p56417825913"></a><a name="p56417825913"></a><span class="parmname" id="parmname864580596"><a name="parmname864580596"></a><a name="parmname864580596"></a>“优选数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p265138145912"><a name="p265138145912"></a><a name="p265138145912"></a>指定网络算子优先选用的数据格式，<span class="parmvalue" id="parmvalue13645845912"><a name="parmvalue13645845912"></a><a name="parmvalue13645845912"></a>“ND（N&lt;=4）”</span>和<span class="parmvalue" id="parmvalue9647815591"><a name="parmvalue9647815591"></a><a name="parmvalue9647815591"></a>“5D”</span>。仅在网络中算子的输入数据同时支持<span class="parmvalue" id="parmvalue16641581598"><a name="parmvalue16641581598"></a><a name="parmvalue16641581598"></a>“ND”</span>和<span class="parmvalue" id="parmvalue66418885910"><a name="parmvalue66418885910"></a><a name="parmvalue66418885910"></a>“5D”</span>两种格式时，指定该参数才会生效。<span class="parmvalue" id="parmvalue14644817595"><a name="parmvalue14644817595"></a><a name="parmvalue14644817595"></a>“ND”</span>表示模型中算子按NCHW转换成通用格式，<span class="parmvalue" id="parmvalue14651285590"><a name="parmvalue14651285590"></a><a name="parmvalue14651285590"></a>“5D”</span>表示模型中算子按华为自研的5维转换成华为格式。<span class="parmvalue" id="parmvalue1365685599"><a name="parmvalue1365685599"></a><a name="parmvalue1365685599"></a>“5D”</span>为默认值。</p>
</td>
</tr>
<tr id="row16658818594"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p10657875910"><a name="p10657875910"></a><a name="p10657875910"></a><span class="parmname" id="parmname1265138205917"><a name="parmname1265138205917"></a><a name="parmname1265138205917"></a>“生成高精度模型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p5651286592"><a name="p5651286592"></a><a name="p5651286592"></a>指定是否生成高精度FP16 Davinci模型。<span class="parmvalue" id="parmvalue2652805913"><a name="parmvalue2652805913"></a><a name="parmvalue2652805913"></a>“0”</span>为默认值，表示生成普通FP16 Davinci模型，推理性能更好。<span class="parmvalue" id="parmvalue166518145912"><a name="parmvalue166518145912"></a><a name="parmvalue166518145912"></a>“1”</span>表示生成高精度FP16 Davinci模型，推理精度更好。高精度当前仅支持Caffe算子（Convolution、Pooling、FullConnection）和TensorFlow算子（tf.nn.conv2d、tf.nn.max_poo）。</p>
</td>
</tr>
<tr id="row1966786596"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="p196514810592"><a name="p196514810592"></a><a name="p196514810592"></a><span class="parmname" id="parmname14651085591"><a name="parmname14651085591"></a><a name="parmname14651085591"></a>“网络输出数据类型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="p26617835920"><a name="p26617835920"></a><a name="p26617835920"></a>FP32为默认值，推荐分类网络、检测网络使用。图像超分辨率网络，推荐使用UINT8，推理性能更好。</p>
</td>
</tr>
</tbody>
</table>

## TF-SavedModel-To-Ascend-C32<a name="section678819203143"></a>

转换Tensorflow框架训练并以“saved\_model“格式保存的模型，转换后模型可在Ascend上运行。转换时支持使用基于TE（Tensor Engine）开发的自定义算子\(TE算子\)。

**表 10**  支持自定义算子转换模板的高级选项

<a name="table17573123151414"></a>
<table><thead align="left"><tr id="modelarts_23_0110_row194110845913"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="modelarts_23_0110_p15413812592"><a name="modelarts_23_0110_p15413812592"></a><a name="modelarts_23_0110_p15413812592"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="modelarts_23_0110_p54117885910"><a name="modelarts_23_0110_p54117885910"></a><a name="modelarts_23_0110_p54117885910"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="modelarts_23_0110_row106358145915"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p46215818597"><a name="modelarts_23_0110_p46215818597"></a><a name="modelarts_23_0110_p46215818597"></a><span class="parmname" id="modelarts_23_0110_parmname56213815914"><a name="modelarts_23_0110_parmname56213815914"></a><a name="modelarts_23_0110_parmname56213815914"></a>“输入张量形状”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p1563482590"><a name="modelarts_23_0110_p1563482590"></a><a name="modelarts_23_0110_p1563482590"></a>模型输入数据的shape，如<span class="parmvalue" id="modelarts_23_0110_parmvalue56219845917"><a name="modelarts_23_0110_parmvalue56219845917"></a><a name="modelarts_23_0110_parmvalue56219845917"></a>“input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2”</span>。<span class="parmname" id="modelarts_23_0110_parmname13621683594"><a name="modelarts_23_0110_parmname13621683594"></a><a name="modelarts_23_0110_parmname13621683594"></a>“input_name”</span>必须是转换前的网络模型中的节点名称。当模型存在动态shape输入时必须提供。例如<span class="parmname" id="modelarts_23_0110_parmname116212845920"><a name="modelarts_23_0110_parmname116212845920"></a><a name="modelarts_23_0110_parmname116212845920"></a>“input_name1:?,h,w,c”</span>，该参数必填，其中“?”为batch数，表示1次处理的图片数量，需要根据实际情况填写，用于将动态shape的原始模型转换为固定shape的离线模型。目前不支持批量特性，转换输入张量形状batch只能为1。转换时系统会解析输入模型获取输入张量并打印在日志中，如果不了解所使用模型的输入张量，可参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row19631781592"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p56328165914"><a name="modelarts_23_0110_p56328165914"></a><a name="modelarts_23_0110_p56328165914"></a><span class="parmname" id="modelarts_23_0110_parmname563884596"><a name="modelarts_23_0110_parmname563884596"></a><a name="modelarts_23_0110_parmname563884596"></a>“输入数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p17636817599"><a name="modelarts_23_0110_p17636817599"></a><a name="modelarts_23_0110_p17636817599"></a>支持NCHW和NHWC，默认是NHWC。当原始框架是TensorFlow时，默认是NHWC。如果实际是NCHW的话，需要通过此参数指定NCHW。原始框架为Caffe时，只支持NCHW格式。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row16643835910"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p763118105920"><a name="modelarts_23_0110_p763118105920"></a><a name="modelarts_23_0110_p763118105920"></a><span class="parmname" id="modelarts_23_0110_parmname1263168135915"><a name="modelarts_23_0110_parmname1263168135915"></a><a name="modelarts_23_0110_parmname1263168135915"></a>“转换输出节点”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p1664148105913"><a name="modelarts_23_0110_p1664148105913"></a><a name="modelarts_23_0110_p1664148105913"></a>指定输出节点，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue863128125920"><a name="modelarts_23_0110_parmvalue863128125920"></a><a name="modelarts_23_0110_parmvalue863128125920"></a>“node_name1:0;node_name1:1;node_name2:0”</span>，其中<span class="parmname" id="modelarts_23_0110_parmname126318885910"><a name="modelarts_23_0110_parmname126318885910"></a><a name="modelarts_23_0110_parmname126318885910"></a>“node_name”</span>必须是模型转换前的网络模型中的节点名称，冒号后的数字表示第几个输出，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue96438195916"><a name="modelarts_23_0110_parmvalue96438195916"></a><a name="modelarts_23_0110_parmvalue96438195916"></a>“node_name1:0”</span>，表示节点名称为<span class="parmname" id="modelarts_23_0110_parmname364986593"><a name="modelarts_23_0110_parmname364986593"></a><a name="modelarts_23_0110_parmname364986593"></a>“node_name1”</span>的第0个输出。如果不指定输出节点，则模型的输出默认为最后一层的算子信息，某些情况下，用户想要查看某层算子参数是否合适，则需要将该层算子的参数输出，即可以在模型转换时通过该参数指定输出某层算子。转换时系统会解析输入模型获取输出节点并打印在日志中，如果不了解所使用模型的输入张量，可以参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row1565586592"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p56417825913"><a name="modelarts_23_0110_p56417825913"></a><a name="modelarts_23_0110_p56417825913"></a><span class="parmname" id="modelarts_23_0110_parmname864580596"><a name="modelarts_23_0110_parmname864580596"></a><a name="modelarts_23_0110_parmname864580596"></a>“优选数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p265138145912"><a name="modelarts_23_0110_p265138145912"></a><a name="modelarts_23_0110_p265138145912"></a>指定网络算子优先选用的数据格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue13645845912"><a name="modelarts_23_0110_parmvalue13645845912"></a><a name="modelarts_23_0110_parmvalue13645845912"></a>“ND（N&lt;=4）”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue9647815591"><a name="modelarts_23_0110_parmvalue9647815591"></a><a name="modelarts_23_0110_parmvalue9647815591"></a>“5D”</span>。仅在网络中算子的输入数据同时支持<span class="parmvalue" id="modelarts_23_0110_parmvalue16641581598"><a name="modelarts_23_0110_parmvalue16641581598"></a><a name="modelarts_23_0110_parmvalue16641581598"></a>“ND”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue66418885910"><a name="modelarts_23_0110_parmvalue66418885910"></a><a name="modelarts_23_0110_parmvalue66418885910"></a>“5D”</span>两种格式时，指定该参数才会生效。<span class="parmvalue" id="modelarts_23_0110_parmvalue14644817595"><a name="modelarts_23_0110_parmvalue14644817595"></a><a name="modelarts_23_0110_parmvalue14644817595"></a>“ND”</span>表示模型中算子按NCHW转换成通用格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue14651285590"><a name="modelarts_23_0110_parmvalue14651285590"></a><a name="modelarts_23_0110_parmvalue14651285590"></a>“5D”</span>表示模型中算子按华为自研的5维转换成华为格式。<span class="parmvalue" id="modelarts_23_0110_parmvalue1365685599"><a name="modelarts_23_0110_parmvalue1365685599"></a><a name="modelarts_23_0110_parmvalue1365685599"></a>“5D”</span>为默认值。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row16658818594"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p10657875910"><a name="modelarts_23_0110_p10657875910"></a><a name="modelarts_23_0110_p10657875910"></a><span class="parmname" id="modelarts_23_0110_parmname1265138205917"><a name="modelarts_23_0110_parmname1265138205917"></a><a name="modelarts_23_0110_parmname1265138205917"></a>“生成高精度模型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p5651286592"><a name="modelarts_23_0110_p5651286592"></a><a name="modelarts_23_0110_p5651286592"></a>指定是否生成高精度FP16 Davinci模型。<span class="parmvalue" id="modelarts_23_0110_parmvalue2652805913"><a name="modelarts_23_0110_parmvalue2652805913"></a><a name="modelarts_23_0110_parmvalue2652805913"></a>“0”</span>为默认值，表示生成普通FP16 Davinci模型，推理性能更好。<span class="parmvalue" id="modelarts_23_0110_parmvalue166518145912"><a name="modelarts_23_0110_parmvalue166518145912"></a><a name="modelarts_23_0110_parmvalue166518145912"></a>“1”</span>表示生成高精度FP16 Davinci模型，推理精度更好。高精度当前仅支持Caffe算子（Convolution、Pooling、FullConnection）和TensorFlow算子（tf.nn.conv2d、tf.nn.max_poo）。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row1966786596"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p196514810592"><a name="modelarts_23_0110_p196514810592"></a><a name="modelarts_23_0110_p196514810592"></a><span class="parmname" id="modelarts_23_0110_parmname14651085591"><a name="modelarts_23_0110_parmname14651085591"></a><a name="modelarts_23_0110_parmname14651085591"></a>“网络输出数据类型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p26617835920"><a name="modelarts_23_0110_p26617835920"></a><a name="modelarts_23_0110_p26617835920"></a>FP32为默认值，推荐分类网络、检测网络使用。图像超分辨率网络，推荐使用UINT8，推理性能更好。</p>
</td>
</tr>
</tbody>
</table>

## TF-FrozenGraph-To-Ascend-HiLens<a name="section18183122161514"></a>

主要提供给华为HiLens使用，当HiLens Kit系统固件版本为2.2.200.011时建议使用此模板进行转换。支持将TensorFlow frozen\_graph模型转换成可在ascend芯片上运行的模型，转换时支持使用基于TE\(Tensor Engine\)开发的自定义算子。

**表 11**  支持自定义算子转换模板的高级选项

<a name="table2552316158"></a>
<table><thead align="left"><tr id="modelarts_23_0110_row1951193231017_2"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="modelarts_23_0110_p851103271017_2"><a name="modelarts_23_0110_p851103271017_2"></a><a name="modelarts_23_0110_p851103271017_2"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="modelarts_23_0110_p1351114322109_2"><a name="modelarts_23_0110_p1351114322109_2"></a><a name="modelarts_23_0110_p1351114322109_2"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="modelarts_23_0110_row18511143212101_2"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p074565765813_2"><a name="modelarts_23_0110_p074565765813_2"></a><a name="modelarts_23_0110_p074565765813_2"></a><span class="parmname" id="modelarts_23_0110_parmname17451757195819_2"><a name="modelarts_23_0110_parmname17451757195819_2"></a><a name="modelarts_23_0110_parmname17451757195819_2"></a>“输入张量形状”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p01741335619_2"><a name="modelarts_23_0110_p01741335619_2"></a><a name="modelarts_23_0110_p01741335619_2"></a>模型输入数据的shape，如<span class="parmvalue" id="modelarts_23_0110_parmvalue16741229121118_2"><a name="modelarts_23_0110_parmvalue16741229121118_2"></a><a name="modelarts_23_0110_parmvalue16741229121118_2"></a>“input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2”</span>。<span class="parmname" id="modelarts_23_0110_parmname1967416299115_2"><a name="modelarts_23_0110_parmname1967416299115_2"></a><a name="modelarts_23_0110_parmname1967416299115_2"></a>“input_name”</span>必须是转换前的网络模型中的节点名称。当模型存在动态shape输入时必须提供。例如<span class="parmname" id="modelarts_23_0110_parmname467462912114_2"><a name="modelarts_23_0110_parmname467462912114_2"></a><a name="modelarts_23_0110_parmname467462912114_2"></a>“input_name1:?,h,w,c”</span>，该参数必填，其中“?”为batch数，表示1次处理的图片数量，需要根据实际情况填写，用于将动态shape的原始模型转换为固定shape的离线模型。目前不支持批量特性，转换输入张量形状batch只能为1。转换时系统会解析输入模型获取输入张量并打印在日志中，如果不了解所使用模型的输入张量，可参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row2070976135919_2"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p270976195913_2"><a name="modelarts_23_0110_p270976195913_2"></a><a name="modelarts_23_0110_p270976195913_2"></a><span class="parmname" id="modelarts_23_0110_parmname11107121995920_2"><a name="modelarts_23_0110_parmname11107121995920_2"></a><a name="modelarts_23_0110_parmname11107121995920_2"></a>“输入数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p1770920611599_2"><a name="modelarts_23_0110_p1770920611599_2"></a><a name="modelarts_23_0110_p1770920611599_2"></a>支持NCHW和NHWC，默认是NHWC。当原始框架是TensorFlow时，默认是NHWC。如果实际是NCHW的话，需要通过此参数指定NCHW。原始框架为Caffe时，只支持NCHW格式。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row457718218590_2"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p357792115918_2"><a name="modelarts_23_0110_p357792115918_2"></a><a name="modelarts_23_0110_p357792115918_2"></a><span class="parmname" id="modelarts_23_0110_parmname7342113205910_2"><a name="modelarts_23_0110_parmname7342113205910_2"></a><a name="modelarts_23_0110_parmname7342113205910_2"></a>“转换输出节点”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p145771224593_2"><a name="modelarts_23_0110_p145771224593_2"></a><a name="modelarts_23_0110_p145771224593_2"></a>指定输出节点，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue187591741716_2"><a name="modelarts_23_0110_parmvalue187591741716_2"></a><a name="modelarts_23_0110_parmvalue187591741716_2"></a>“node_name1:0;node_name1:1;node_name2:0”</span>，其中<span class="parmname" id="modelarts_23_0110_parmname1975964417_2"><a name="modelarts_23_0110_parmname1975964417_2"></a><a name="modelarts_23_0110_parmname1975964417_2"></a>“node_name”</span>必须是模型转换前的网络模型中的节点名称，冒号后的数字表示第几个输出，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue576020415112_2"><a name="modelarts_23_0110_parmvalue576020415112_2"></a><a name="modelarts_23_0110_parmvalue576020415112_2"></a>“node_name1:0”</span>，表示节点名称为<span class="parmname" id="modelarts_23_0110_parmname18760341517_2"><a name="modelarts_23_0110_parmname18760341517_2"></a><a name="modelarts_23_0110_parmname18760341517_2"></a>“node_name1”</span>的第0个输出。如果不指定输出节点，则模型的输出默认为最后一层的算子信息，某些情况下，用户想要查看某层算子参数是否合适，则需要将该层算子的参数输出，即可以在模型转换时通过该参数指定输出某层算子。转换时系统会解析输入模型获取输出节点并打印在日志中，如果不了解所使用模型的输入张量，可以参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row239453865914_2"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p739413812590_2"><a name="modelarts_23_0110_p739413812590_2"></a><a name="modelarts_23_0110_p739413812590_2"></a><span class="parmname" id="modelarts_23_0110_parmname37739541591_2"><a name="modelarts_23_0110_parmname37739541591_2"></a><a name="modelarts_23_0110_parmname37739541591_2"></a>“优选数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p123949383592_2"><a name="modelarts_23_0110_p123949383592_2"></a><a name="modelarts_23_0110_p123949383592_2"></a>指定网络算子优先选用的数据格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue31736351003_2"><a name="modelarts_23_0110_parmvalue31736351003_2"></a><a name="modelarts_23_0110_parmvalue31736351003_2"></a>“ND（N&lt;=4）”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue617363512017_2"><a name="modelarts_23_0110_parmvalue617363512017_2"></a><a name="modelarts_23_0110_parmvalue617363512017_2"></a>“5D”</span>。仅在网络中算子的输入数据同时支持<span class="parmvalue" id="modelarts_23_0110_parmvalue1617393519018_2"><a name="modelarts_23_0110_parmvalue1617393519018_2"></a><a name="modelarts_23_0110_parmvalue1617393519018_2"></a>“ND”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue817310357018_2"><a name="modelarts_23_0110_parmvalue817310357018_2"></a><a name="modelarts_23_0110_parmvalue817310357018_2"></a>“5D”</span>两种格式时，指定该参数才会生效。<span class="parmvalue" id="modelarts_23_0110_parmvalue417310356011_2"><a name="modelarts_23_0110_parmvalue417310356011_2"></a><a name="modelarts_23_0110_parmvalue417310356011_2"></a>“ND”</span>表示模型中算子按NCHW转换成通用格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue9173113519013_2"><a name="modelarts_23_0110_parmvalue9173113519013_2"></a><a name="modelarts_23_0110_parmvalue9173113519013_2"></a>“5D”</span>表示模型中算子按华为自研的5维转换成华为格式。<span class="parmvalue" id="modelarts_23_0110_parmvalue01733354016_2"><a name="modelarts_23_0110_parmvalue01733354016_2"></a><a name="modelarts_23_0110_parmvalue01733354016_2"></a>“5D”</span>为默认值。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row18385134265914_2"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p138554255911_2"><a name="modelarts_23_0110_p138554255911_2"></a><a name="modelarts_23_0110_p138554255911_2"></a><span class="parmname" id="modelarts_23_0110_parmname41921813011_2"><a name="modelarts_23_0110_parmname41921813011_2"></a><a name="modelarts_23_0110_parmname41921813011_2"></a>“生成高精度模型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p5385124220595_2"><a name="modelarts_23_0110_p5385124220595_2"></a><a name="modelarts_23_0110_p5385124220595_2"></a>指定是否生成高精度FP16 Davinci模型。<span class="parmvalue" id="modelarts_23_0110_parmvalue398914277020_2"><a name="modelarts_23_0110_parmvalue398914277020_2"></a><a name="modelarts_23_0110_parmvalue398914277020_2"></a>“0”</span>为默认值，表示生成普通FP16 Davinci模型，推理性能更好。<span class="parmvalue" id="modelarts_23_0110_parmvalue189899273018_2"><a name="modelarts_23_0110_parmvalue189899273018_2"></a><a name="modelarts_23_0110_parmvalue189899273018_2"></a>“1”</span>表示生成高精度FP16 Davinci模型，推理精度更好。高精度当前仅支持Caffe算子（Convolution、Pooling、FullConnection）和TensorFlow算子（tf.nn.conv2d、tf.nn.max_poo）。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row8560962014_2"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p2561261001_2"><a name="modelarts_23_0110_p2561261001_2"></a><a name="modelarts_23_0110_p2561261001_2"></a><span class="parmname" id="modelarts_23_0110_parmname115211915807_2"><a name="modelarts_23_0110_parmname115211915807_2"></a><a name="modelarts_23_0110_parmname115211915807_2"></a>“网络输出数据类型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p226414215013_2"><a name="modelarts_23_0110_p226414215013_2"></a><a name="modelarts_23_0110_p226414215013_2"></a>FP32为默认值，推荐分类网络、检测网络使用。图像超分辨率网络，推荐使用UINT8，推理性能更好。</p>
</td>
</tr>
</tbody>
</table>

## TF-SavedModel-To-Ascend-HiLens<a name="section2098120596165"></a>

主要提供给华为HiLens使用，当HiLens Kit系统固件版本为2.2.200.011时建议使用此模板进行转换。支持将TensorFlow saved\_model模型转换成可在ascend芯片上运行的模型，转换时支持使用基于TE\(Tensor Engine\)开发的自定义算子。

**表 12**  支持自定义算子转换模板的高级选项

<a name="table01919613178"></a>
<table><thead align="left"><tr id="modelarts_23_0110_row1951193231017_3"><th class="cellrowborder" valign="top" width="26%" id="mcps1.2.3.1.1"><p id="modelarts_23_0110_p851103271017_3"><a name="modelarts_23_0110_p851103271017_3"></a><a name="modelarts_23_0110_p851103271017_3"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="74%" id="mcps1.2.3.1.2"><p id="modelarts_23_0110_p1351114322109_3"><a name="modelarts_23_0110_p1351114322109_3"></a><a name="modelarts_23_0110_p1351114322109_3"></a>参数解释</p>
</th>
</tr>
</thead>
<tbody><tr id="modelarts_23_0110_row18511143212101_3"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p074565765813_3"><a name="modelarts_23_0110_p074565765813_3"></a><a name="modelarts_23_0110_p074565765813_3"></a><span class="parmname" id="modelarts_23_0110_parmname17451757195819_3"><a name="modelarts_23_0110_parmname17451757195819_3"></a><a name="modelarts_23_0110_parmname17451757195819_3"></a>“输入张量形状”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p01741335619_3"><a name="modelarts_23_0110_p01741335619_3"></a><a name="modelarts_23_0110_p01741335619_3"></a>模型输入数据的shape，如<span class="parmvalue" id="modelarts_23_0110_parmvalue16741229121118_3"><a name="modelarts_23_0110_parmvalue16741229121118_3"></a><a name="modelarts_23_0110_parmvalue16741229121118_3"></a>“input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2”</span>。<span class="parmname" id="modelarts_23_0110_parmname1967416299115_3"><a name="modelarts_23_0110_parmname1967416299115_3"></a><a name="modelarts_23_0110_parmname1967416299115_3"></a>“input_name”</span>必须是转换前的网络模型中的节点名称。当模型存在动态shape输入时必须提供。例如<span class="parmname" id="modelarts_23_0110_parmname467462912114_3"><a name="modelarts_23_0110_parmname467462912114_3"></a><a name="modelarts_23_0110_parmname467462912114_3"></a>“input_name1:?,h,w,c”</span>，该参数必填，其中“?”为batch数，表示1次处理的图片数量，需要根据实际情况填写，用于将动态shape的原始模型转换为固定shape的离线模型。目前不支持批量特性，转换输入张量形状batch只能为1。转换时系统会解析输入模型获取输入张量并打印在日志中，如果不了解所使用模型的输入张量，可参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row2070976135919_3"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p270976195913_3"><a name="modelarts_23_0110_p270976195913_3"></a><a name="modelarts_23_0110_p270976195913_3"></a><span class="parmname" id="modelarts_23_0110_parmname11107121995920_3"><a name="modelarts_23_0110_parmname11107121995920_3"></a><a name="modelarts_23_0110_parmname11107121995920_3"></a>“输入数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p1770920611599_3"><a name="modelarts_23_0110_p1770920611599_3"></a><a name="modelarts_23_0110_p1770920611599_3"></a>支持NCHW和NHWC，默认是NHWC。当原始框架是TensorFlow时，默认是NHWC。如果实际是NCHW的话，需要通过此参数指定NCHW。原始框架为Caffe时，只支持NCHW格式。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row457718218590_3"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p357792115918_3"><a name="modelarts_23_0110_p357792115918_3"></a><a name="modelarts_23_0110_p357792115918_3"></a><span class="parmname" id="modelarts_23_0110_parmname7342113205910_3"><a name="modelarts_23_0110_parmname7342113205910_3"></a><a name="modelarts_23_0110_parmname7342113205910_3"></a>“转换输出节点”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p145771224593_3"><a name="modelarts_23_0110_p145771224593_3"></a><a name="modelarts_23_0110_p145771224593_3"></a>指定输出节点，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue187591741716_3"><a name="modelarts_23_0110_parmvalue187591741716_3"></a><a name="modelarts_23_0110_parmvalue187591741716_3"></a>“node_name1:0;node_name1:1;node_name2:0”</span>，其中<span class="parmname" id="modelarts_23_0110_parmname1975964417_3"><a name="modelarts_23_0110_parmname1975964417_3"></a><a name="modelarts_23_0110_parmname1975964417_3"></a>“node_name”</span>必须是模型转换前的网络模型中的节点名称，冒号后的数字表示第几个输出，例如<span class="parmvalue" id="modelarts_23_0110_parmvalue576020415112_3"><a name="modelarts_23_0110_parmvalue576020415112_3"></a><a name="modelarts_23_0110_parmvalue576020415112_3"></a>“node_name1:0”</span>，表示节点名称为<span class="parmname" id="modelarts_23_0110_parmname18760341517_3"><a name="modelarts_23_0110_parmname18760341517_3"></a><a name="modelarts_23_0110_parmname18760341517_3"></a>“node_name1”</span>的第0个输出。如果不指定输出节点，则模型的输出默认为最后一层的算子信息，某些情况下，用户想要查看某层算子参数是否合适，则需要将该层算子的参数输出，即可以在模型转换时通过该参数指定输出某层算子。转换时系统会解析输入模型获取输出节点并打印在日志中，如果不了解所使用模型的输入张量，可以参考日志中的解析结果。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row239453865914_3"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p739413812590_3"><a name="modelarts_23_0110_p739413812590_3"></a><a name="modelarts_23_0110_p739413812590_3"></a><span class="parmname" id="modelarts_23_0110_parmname37739541591_3"><a name="modelarts_23_0110_parmname37739541591_3"></a><a name="modelarts_23_0110_parmname37739541591_3"></a>“优选数据格式”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p123949383592_3"><a name="modelarts_23_0110_p123949383592_3"></a><a name="modelarts_23_0110_p123949383592_3"></a>指定网络算子优先选用的数据格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue31736351003_3"><a name="modelarts_23_0110_parmvalue31736351003_3"></a><a name="modelarts_23_0110_parmvalue31736351003_3"></a>“ND（N&lt;=4）”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue617363512017_3"><a name="modelarts_23_0110_parmvalue617363512017_3"></a><a name="modelarts_23_0110_parmvalue617363512017_3"></a>“5D”</span>。仅在网络中算子的输入数据同时支持<span class="parmvalue" id="modelarts_23_0110_parmvalue1617393519018_3"><a name="modelarts_23_0110_parmvalue1617393519018_3"></a><a name="modelarts_23_0110_parmvalue1617393519018_3"></a>“ND”</span>和<span class="parmvalue" id="modelarts_23_0110_parmvalue817310357018_3"><a name="modelarts_23_0110_parmvalue817310357018_3"></a><a name="modelarts_23_0110_parmvalue817310357018_3"></a>“5D”</span>两种格式时，指定该参数才会生效。<span class="parmvalue" id="modelarts_23_0110_parmvalue417310356011_3"><a name="modelarts_23_0110_parmvalue417310356011_3"></a><a name="modelarts_23_0110_parmvalue417310356011_3"></a>“ND”</span>表示模型中算子按NCHW转换成通用格式，<span class="parmvalue" id="modelarts_23_0110_parmvalue9173113519013_3"><a name="modelarts_23_0110_parmvalue9173113519013_3"></a><a name="modelarts_23_0110_parmvalue9173113519013_3"></a>“5D”</span>表示模型中算子按华为自研的5维转换成华为格式。<span class="parmvalue" id="modelarts_23_0110_parmvalue01733354016_3"><a name="modelarts_23_0110_parmvalue01733354016_3"></a><a name="modelarts_23_0110_parmvalue01733354016_3"></a>“5D”</span>为默认值。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row18385134265914_3"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p138554255911_3"><a name="modelarts_23_0110_p138554255911_3"></a><a name="modelarts_23_0110_p138554255911_3"></a><span class="parmname" id="modelarts_23_0110_parmname41921813011_3"><a name="modelarts_23_0110_parmname41921813011_3"></a><a name="modelarts_23_0110_parmname41921813011_3"></a>“生成高精度模型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p5385124220595_3"><a name="modelarts_23_0110_p5385124220595_3"></a><a name="modelarts_23_0110_p5385124220595_3"></a>指定是否生成高精度FP16 Davinci模型。<span class="parmvalue" id="modelarts_23_0110_parmvalue398914277020_3"><a name="modelarts_23_0110_parmvalue398914277020_3"></a><a name="modelarts_23_0110_parmvalue398914277020_3"></a>“0”</span>为默认值，表示生成普通FP16 Davinci模型，推理性能更好。<span class="parmvalue" id="modelarts_23_0110_parmvalue189899273018_3"><a name="modelarts_23_0110_parmvalue189899273018_3"></a><a name="modelarts_23_0110_parmvalue189899273018_3"></a>“1”</span>表示生成高精度FP16 Davinci模型，推理精度更好。高精度当前仅支持Caffe算子（Convolution、Pooling、FullConnection）和TensorFlow算子（tf.nn.conv2d、tf.nn.max_poo）。</p>
</td>
</tr>
<tr id="modelarts_23_0110_row8560962014_3"><td class="cellrowborder" valign="top" width="26%" headers="mcps1.2.3.1.1 "><p id="modelarts_23_0110_p2561261001_3"><a name="modelarts_23_0110_p2561261001_3"></a><a name="modelarts_23_0110_p2561261001_3"></a><span class="parmname" id="modelarts_23_0110_parmname115211915807_3"><a name="modelarts_23_0110_parmname115211915807_3"></a><a name="modelarts_23_0110_parmname115211915807_3"></a>“网络输出数据类型”</span></p>
</td>
<td class="cellrowborder" valign="top" width="74%" headers="mcps1.2.3.1.2 "><p id="modelarts_23_0110_p226414215013_3"><a name="modelarts_23_0110_p226414215013_3"></a><a name="modelarts_23_0110_p226414215013_3"></a>FP32为默认值，推荐分类网络、检测网络使用。图像超分辨率网络，推荐使用UINT8，推理性能更好。</p>
</td>
</tr>
</tbody>
</table>

