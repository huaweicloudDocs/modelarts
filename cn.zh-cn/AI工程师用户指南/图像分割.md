# 图像分割<a name="modelarts_23_0345"></a>

由于模型训练过程需要大量有标签的图片数据，因此在模型训练之前需对没有标签的图片添加标签。您可以通过在ModelArts控制台进行标注，也可以对已标注图片修改或删除标签进行重新标注。

针对图像分割场景，开始标注前，您需要了解：

-   图片中需要提取轮廓的物体都要标注。
-   支持使用多边形标注和极点标注。
    -   多边形标注，根据目标物体的轮廓绘制多边形。
    -   极点标注，在目标物体轮廓的最上、最左、最下、最右的位置分别标注四个极点，极点要在物体的轮廓上。系统将根据标注的极点推理出物体的轮廓。对于背景比较复杂的图片，极点标注效果不佳，推荐使用多边形标注。

-   多边形标注时，标注框或极点，必须在图片范围内，超出图片将导致后续作业异常。

## 开始标注<a name="section139520290612"></a>

1.  登录ModelArts管理控制台，在左侧菜单栏中选择“数据管理\> 数据标注“，进入“数据标注“管理页面。
2.  在数据集列表中，基于“标注类型“选择需要进行标注的数据集，单击标注作业名称进入标注作业标注详情页。
3.  在标注作业标注详情中，展示此标注作业下全部数据。

## 同步新数据<a name="section616011413170"></a>

ModelArts会自动将数据集中新增的数据同步至标注作业，包含数据及当前标注作业支持的标注信息。

为了快速获取数据集中最新数据，可在标注作业详情页的“全部“、“未标注“或“已标注“页签中，单击“同步新数据“，快速将数据集中的数据添加到标注作业中。

## 筛选数据<a name="section241219920154"></a>

在标注作业详情页面，默认展示作业中全部数据，您可以在“全部“、“未标注“或“已标注“页签下，在筛选条件区域，单击“展开“，添加筛选条件，快速过滤出您想要查看的数据。

支持的筛选条件如下所示，您可以设置一个或多个选项进行筛选。

-   难例集：难例或非难例。
-   标签：您可以选择全部标签，或者基于您指定的标签，选中其中一个或多个。
-   样本创建时间：1个月内、1天内或自定义，如果选择自定义，可以在时间框中指定明确时间范围。
-   文件名或目录：根据文件名称或者文件存储目录筛选。
-   标注人：选择执行标注操作的帐号名称。
-   样本属性：表示自动分组生成的属性。只有启用了[自动分组](https://support.huaweicloud.com/engineers-modelarts/modelarts_23_0213.html)任务后才可使用此筛选条件。
-   数据属性：暂不支持。

**图 1**  筛选条件<a name="modelarts_23_0011_fig8961459161717"></a>  
![](figures/筛选条件.png "筛选条件")

## 标注图片（手工标注）<a name="section888019266174"></a>

标注作业详情页中，展示了此标注作业中“未标注“和“已标注“的图片，默认显示“全部“的图片列表。

1.  在“未标注“页签图片列表中，单击图片，自动跳转到标注页面。在标注页面，常用按钮的使用可参见[表2](#table194471512463)。
2.  选择标注方式。

    在标注页面，上方工具栏提供了常用的[标注方式](#table165201739119)及[常用按钮](#table194471512463)，系统默认的标注方式为多边形标注。选择多边形标注或极点标注。

    >![](public_sys-resources/icon-note.gif) **说明：** 
    >标注第一张图片时，一旦选择其中一种，其他所有图片都需要使用此方式进行标注。

    **图 2**  工具栏<a name="fig1362531203220"></a>  
    ![](figures/工具栏.png "工具栏")

    **表 1**  标注方式

    <a name="table165201739119"></a>
    <table><thead align="left"><tr id="row45211039618"><th class="cellrowborder" valign="top" width="21.78%" id="mcps1.2.3.1.1"><p id="p25211339716"><a name="p25211339716"></a><a name="p25211339716"></a>图标</p>
    </th>
    <th class="cellrowborder" valign="top" width="78.22%" id="mcps1.2.3.1.2"><p id="p145214391119"><a name="p145214391119"></a><a name="p145214391119"></a>使用说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row1552113392120"><td class="cellrowborder" valign="top" width="21.78%" headers="mcps1.2.3.1.1 "><p id="p216911136249"><a name="p216911136249"></a><a name="p216911136249"></a><a name="image493931633217"></a><a name="image493931633217"></a><span><img id="image493931633217" src="figures/zh-cn_image_0000001185384487.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="78.22%" headers="mcps1.2.3.1.2 "><p id="p1227619435328"><a name="p1227619435328"></a><a name="p1227619435328"></a>多边形。在标注对象所在范围内，鼠标左键单击完成一个点的标注，沿着物体的形状边缘，通过鼠标指定多个点，最终单击到第一个点的位置，由所有的点组成一个多边形形状。使得需标注的对象在此标注框内。</p>
    </td>
    </tr>
    <tr id="row2052111391612"><td class="cellrowborder" valign="top" width="21.78%" headers="mcps1.2.3.1.1 "><p id="p561215612412"><a name="p561215612412"></a><a name="p561215612412"></a><a name="image1496062693212"></a><a name="image1496062693212"></a><span><img id="image1496062693212" src="figures/zh-cn_image_0000001185265303.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="78.22%" headers="mcps1.2.3.1.2 "><p id="p493615717328"><a name="p493615717328"></a><a name="p493615717328"></a>极点标注。在目标物体轮廓的最上、最左、最下、最右的位置分别标注四个极点，极点要在物体的轮廓上。系统将根据标注的极点推理出物体的轮廓。</p>
    </td>
    </tr>
    </tbody>
    </table>

    **表 2**  工具栏常用按钮

    <a name="table194471512463"></a>
    <table><thead align="left"><tr id="row18447951114610"><th class="cellrowborder" valign="top" width="22.62%" id="mcps1.2.3.1.1"><p id="p644735174612"><a name="p644735174612"></a><a name="p644735174612"></a>按钮图标</p>
    </th>
    <th class="cellrowborder" valign="top" width="77.38000000000001%" id="mcps1.2.3.1.2"><p id="p8447951194610"><a name="p8447951194610"></a><a name="p8447951194610"></a>功能说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row644714515462"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p194471551144618"><a name="p194471551144618"></a><a name="p194471551144618"></a><a name="image17418425291"></a><a name="image17418425291"></a><span><img id="image17418425291" src="figures/icon_15-0.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p18447165104619"><a name="p18447165104619"></a><a name="p18447165104619"></a>撤销上一个操作。</p>
    </td>
    </tr>
    <tr id="row20447125118461"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p134474513468"><a name="p134474513468"></a><a name="p134474513468"></a><a name="image18787181683014"></a><a name="image18787181683014"></a><span><img id="image18787181683014" src="figures/icon_16-1.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p5447195154616"><a name="p5447195154616"></a><a name="p5447195154616"></a>重做上一个操作。</p>
    </td>
    </tr>
    <tr id="row1644765117461"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p244785154613"><a name="p244785154613"></a><a name="p244785154613"></a><a name="image15366116173217"></a><a name="image15366116173217"></a><span><img id="image15366116173217" src="figures/icon_17-2.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p64475516466"><a name="p64475516466"></a><a name="p64475516466"></a>放大图片。</p>
    </td>
    </tr>
    <tr id="row1944755120463"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p34471051104616"><a name="p34471051104616"></a><a name="p34471051104616"></a><a name="image23261509320"></a><a name="image23261509320"></a><span><img id="image23261509320" src="figures/icon_18-3.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p1544817513466"><a name="p1544817513466"></a><a name="p1544817513466"></a>缩小图片。</p>
    </td>
    </tr>
    <tr id="row8448125115465"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p744855124615"><a name="p744855124615"></a><a name="p744855124615"></a><a name="image1880924765016"></a><a name="image1880924765016"></a><span><img id="image1880924765016" src="figures/icon_19-4.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p174482515464"><a name="p174482515464"></a><a name="p174482515464"></a>删除当前图片中的所有标注框。</p>
    </td>
    </tr>
    <tr id="row18448135113463"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p1744855184617"><a name="p1744855184617"></a><a name="p1744855184617"></a><a name="image594151520342"></a><a name="image594151520342"></a><span><img id="image594151520342" src="figures/icon_20-5.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p94485516460"><a name="p94485516460"></a><a name="p94485516460"></a>显示或隐藏标注框。只有在已标注图片中可使用此操作。</p>
    </td>
    </tr>
    <tr id="row1844812519463"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p744815184612"><a name="p744815184612"></a><a name="p744815184612"></a><a name="image8599192153511"></a><a name="image8599192153511"></a><span><img id="image8599192153511" src="figures/icon_21-6.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p1944845119464"><a name="p1944845119464"></a><a name="p1944845119464"></a>拖动，可将标注好的框拖动至其他位置，也可以选择框的边缘，更改框的大小。</p>
    </td>
    </tr>
    <tr id="row6436356154711"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p3437756124712"><a name="p3437756124712"></a><a name="p3437756124712"></a><a name="image201771540113617"></a><a name="image201771540113617"></a><span><img id="image201771540113617" src="figures/icon_22-7.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p44381456124719"><a name="p44381456124719"></a><a name="p44381456124719"></a>复位，与上方拖动为同组操作，当执行了拖动后，可以单击复位按钮快速将标注框恢复为拖动前的形状和位置。</p>
    </td>
    </tr>
    <tr id="row1443895694719"><td class="cellrowborder" valign="top" width="22.62%" headers="mcps1.2.3.1.1 "><p id="p94381056204713"><a name="p94381056204713"></a><a name="p94381056204713"></a><a name="image615641043716"></a><a name="image615641043716"></a><span><img id="image615641043716" src="figures/icon_23-8.png"></span></p>
    </td>
    <td class="cellrowborder" valign="top" width="77.38000000000001%" headers="mcps1.2.3.1.2 "><p id="p443817567478"><a name="p443817567478"></a><a name="p443817567478"></a>全屏显示标注的图片。</p>
    </td>
    </tr>
    </tbody>
    </table>

3.  标注物体。

    以极点标注为例。识别图片中的物体，单击左键分别定位物体的最上、最左、最下、最右的位置点。确定位置后，将弹出对话框，填入标签名称，单击确定添加物体的标签。确定后系统将自动推理出物体的轮廓。

    完成一张图片标注后，可单击图片下方图片列表，快速选中其他未标注的图片，然后在标注页面中执行标注操作。

    **图 3**  标注物体轮廓<a name="fig16575195124518"></a>  
    ![](figures/标注物体轮廓.gif "标注物体轮廓")

4.  单击页面上方“返回数据标注预览“查看标注信息，在弹框中单击“确定“保存当前标注并离开标注页面。

    选中的图片被自动移动至“已标注“页签，且在“未标注“和“全部“页签中，标签的信息也将随着标注步骤进行更新，如增加的标签名称、标签对应的图片数量。


## 查看已标注图片<a name="section2958731141718"></a>

在标注作业详情页中，单击“已标注“页签，您可以查看已完成标注的图片列表。单击图片，可在右侧的“当前文件标签“中了解当前图片的标签信息。

## 修改标注信息<a name="section0534612151819"></a>

当数据完成标注后，您还可以进入已标注页签，对已标注的数据进行修改。

在数据标注详情页面，单击“已标注“页签，然后在图片列表中选中待修改的图片，单击图片跳转到标注页面，在右侧标签信息区域中单击此图片已添加的标注信息。

-   修改标签：“标注“区域中，单击编辑图标，在弹出框中输入正确的标签名或标签颜色，然后单击“确定“完成修改。也可以单击标签，在图片标注区域，调整标注框的位置和大小，完成调整后，单击其他标签即可保存修改。
-   修改图片标注信息：在图片展示区，显示物体边缘，可单击蓝色圆点，将标注框调整至物体边缘。
-   删除标签：在“标注“区域中，单击删除图标即可删除此图片中的标签。图片的标签全部删除后，该图片会重新回到“未标注“页签。

标注标注信息修改后，单击页面左上角的“返回数据标注预览“离开标注页面，在弹出对话框中单击“确定“保存修改。

**图 4**  编辑标注信息<a name="zh-cn_topic_0170889732_fig16709173213107"></a>  
![](figures/编辑标注信息.gif "编辑标注信息")

## 添加数据<a name="section17930142915253"></a>

除了同步数据集中的新数据外，您还可以在标注作业中，直接添加图片，用于数据标注。添加的数据将先导入至标注任务关联的数据集中，然后标注任务会自动同步数据集中最新的数据。

1.  在标注作业详情页面，单击“全部“或“未标注“页签，然后单击左上角“添加数据“，选择添加数据。

    **图 5**  添加数据<a name="modelarts_23_0011_fig12389131281315"></a>  
    ![](figures/添加数据.png "添加数据")

2.  在弹出的导入对话框中，选择数据来源和导入方式，选择导入的数据路径和数据标注状态。

    **图 6**  添加图片<a name="modelarts_23_0011_fig1921723819134"></a>  
    ![](figures/添加图片.png "添加图片")

    ![](figures/zh-cn_image_0000001195454731.png)

3.  在导入对话框中，单击“确定“，完成添加数据的操作。

    您添加的图片将自动呈现在“全部“的图片列表中。


## 删除图片<a name="section15379942161810"></a>

通过数据删除操作，可将需要丢弃的图片数据快速删除。

在“全部“、“未标注“或“已标注“页面中，依次选中需要删除的图片，或者选择“选择当前页“选中该页面所有图片，然后单击左上角“删除图片“。在弹出的对话框中，根据实际情况选择是否勾选“同时删除源文件“，确认信息无误后，单击“确定“完成图片删除操作。

其中，被选中的图片，其左上角将显示为勾选状态。如果当前页面无选中图片时，“删除图片“按钮为灰色，无法执行删除操作。

>![](public_sys-resources/icon-note.gif) **说明：** 
>如果勾选了“同时删除源文件“，删除图片操作将删除对应OBS目录下存储的图片，此操作可能会影响已使用此源文件的其他数据集或数据集版本，有可能导致展示异常或训练/推理异常。删除后，数据将无法恢复，请谨慎操作。

